# 지문생성 프롬프트 사용 절차

## 1. 지문생성용 프롬프트 사용 vs 미사용 차이

### 방식 A: LC/RC 프롬프트만 사용 (1/19 버전 방식)

```
┌─────────────────────────────────────────────────────────┐
│                    LC01 프롬프트                         │
│  ┌─────────────────────────────────────────────────┐   │
│  │ • 평가 목표 정의                                  │   │
│  │ • 담화 유형 및 구조 지침                          │   │
│  │ • 언어적 명세 (단어 수, 문장 복잡도)              │   │
│  │ • 지문 생성 가이드라인                           │   │
│  │ • 문항 형식 요구사항                             │   │
│  │ • 오답 설계 지침                                 │   │
│  │ • JSON 출력 형식                                 │   │
│  └─────────────────────────────────────────────────┘   │
│                         ↓                               │
│              LLM이 한 번에 모두 생성                     │
│                         ↓                               │
│         지문(lc_script) + 문항 + 선택지 + 해설           │
└─────────────────────────────────────────────────────────┘
```

**특징:**
- 하나의 긴 프롬프트로 모든 것을 생성
- LLM API 호출 1회
- 지문과 문항이 동시에 생성되어 일관성 있음
- 단점: 프롬프트가 매우 길어짐 (토큰 비용 증가)

---

### 방식 B: P시리즈 + LC/RC 분리 사용 (1/24 버전 방식)

```
┌──────────────────────┐     ┌──────────────────────┐
│   P01 프롬프트        │     │   LC01 프롬프트       │
│  (지문 생성 전용)      │     │  (문항 생성 전용)      │
│  ┌────────────────┐  │     │  ┌────────────────┐  │
│  │ • KSAT 스타일   │  │     │  │ • 문항 형식     │  │
│  │ • M:/W: 형식    │  │     │  │ • 선택지 설계   │  │
│  │ • 적정 길이     │  │     │  │ • 오답 설계     │  │
│  │ • 자연스러운    │  │     │  │ • JSON 출력     │  │
│  │   대화 흐름     │  │     │  └────────────────┘  │
│  └────────────────┘  │     │                      │
└──────────┬───────────┘     └──────────┬───────────┘
           │                            │
           ↓                            │
    ┌──────────────┐                    │
    │ 지문만 생성   │────────────────────┘
    │ (lc_script)  │        지문을 입력으로 전달
    └──────────────┘                    │
                                        ↓
                              ┌──────────────────┐
                              │ 문항 + 선택지     │
                              │ + 해설 생성       │
                              └──────────────────┘
```

---

### 비교표

| 항목 | 방식 A (통합) | 방식 B (분리) |
|------|--------------|--------------|
| **API 호출 수** | 1회 | 2회 |
| **프롬프트 길이** | 매우 김 (3000+ 토큰) | 짧음 (각 500 토큰 이하) |
| **지문 품질 제어** | 간접적 | **직접적** (검토 후 진행 가능) |
| **재사용성** | 낮음 | **높음** (같은 지문으로 다른 문항 생성) |
| **디버깅** | 어려움 | **쉬움** (단계별 확인) |
| **유연성** | 낮음 | **높음** (지문 수정 후 재생성) |
| **비용** | 한 번에 많이 | 나눠서 지불 |

---

## 2. 지문생성용 프롬프트 사용 절차 (Process)

### 2단계 생성 프로세스

```
┌─────────────────────────────────────────────────────────────────┐
│                        STEP 1: 지문 생성                         │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  입력:                                                          │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ • PASSAGE_MASTER (시스템 프롬프트)                        │   │
│  │ • P01~P45 중 해당 프롬프트 (예: P18 for RC18)            │   │
│  │ • 사용자 입력: 주제(TOPIC), 난이도(LEVEL)                 │   │
│  └─────────────────────────────────────────────────────────┘   │
│                              ↓                                  │
│                       LLM API 호출 #1                           │
│                              ↓                                  │
│  출력:                                                          │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ 영어 지문만 출력 (문항, 선택지 없음)                       │   │
│  │                                                         │   │
│  │ "The concept of emotional intelligence has gained..."   │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  [선택적] 지문 검토 및 수정                                      │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│                        STEP 2: 문항 생성                         │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  입력:                                                          │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ • MASTER_PROMPT (시스템 프롬프트)                         │   │
│  │ • LC01~RC45 중 해당 프롬프트 (예: RC18)                   │   │
│  │ • STEP 1에서 생성된 지문                                  │   │
│  └─────────────────────────────────────────────────────────┘   │
│                              ↓                                  │
│                       LLM API 호출 #2                           │
│                              ↓                                  │
│  출력:                                                          │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ {                                                       │   │
│  │   "question": "다음 글의 목적으로...",                   │   │
│  │   "passage": "[STEP 1 지문]",                           │   │
│  │   "options": ["①...", "②...", ...],                    │   │
│  │   "answer": 3,                                          │   │
│  │   "explanation": "..."                                  │   │
│  │ }                                                       │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

### 실제 사용 예시 (의사코드)

```javascript
// STEP 1: 지문 생성
const passagePrompt = getPrompt("PASSAGE_MASTER") + getPrompt("P22");
const userInput = { topic: "환경보호", level: "중" };

const passage = await callLLM({
  system: passagePrompt,
  user: `TOPIC: ${userInput.topic}, LEVEL: ${userInput.level}`
});

// [선택적] 지문 검토
console.log("생성된 지문:", passage);
// 필요시 수정...

// STEP 2: 문항 생성
const itemPrompt = getPrompt("MASTER_PROMPT") + getPrompt("RC22");

const item = await callLLM({
  system: itemPrompt,
  user: `다음 지문을 사용하여 문항을 생성하시오:\n\n${passage}`
});

// 최종 결과
console.log("완성된 문항:", item);
```

---

## 3. 분리 방식의 장점 상세

| 장점 | 설명 |
|------|------|
| **품질 제어** | 지문 생성 후 검토하여 부적절하면 재생성 가능 |
| **비용 절감** | 지문이 좋으면 문항만 여러 번 재생성 가능 |
| **유연성** | 같은 지문으로 다른 유형의 문항 생성 가능 |
| **디버깅** | 문제 발생 시 어느 단계에서 문제인지 파악 용이 |
| **지문 재활용** | 좋은 지문을 저장해두고 나중에 재사용 |
| **A/B 테스트** | 같은 지문, 다른 문항으로 난이도 비교 가능 |

---

## 4. 프롬프트 파일 참조

### 시스템 프롬프트
- `MASTER_PROMPT`: 문항 생성 시스템 프롬프트
- `PASSAGE_MASTER`: 지문 생성 시스템 프롬프트

### 지문 생성 프롬프트 (P시리즈)
- `P01` ~ `P17`: LC(듣기) 지문 생성용
- `P18` ~ `P45`: RC(독해) 지문 생성용

### 문항 생성 프롬프트
- `LC01` ~ `LC17`: 듣기 문항 생성용
- `RC18` ~ `RC45`: 독해 문항 생성용

---

## 5. 권장 사용 시나리오

### 시나리오 1: 빠른 프로토타이핑
- **방식 A (통합)** 사용
- 한 번의 호출로 전체 문항 생성
- 품질보다 속도가 중요할 때

### 시나리오 2: 고품질 문항 제작
- **방식 B (분리)** 사용
- 지문 품질 확보 후 문항 생성
- 출제 위원 검토가 필요할 때

### 시나리오 3: 지문 재활용
- **방식 B (분리)** 사용
- 좋은 지문 하나로 여러 유형의 문항 생성
- 비용 효율이 중요할 때

---

*작성일: 2026-01-28*
