# CSAT MJ Generator - μ•± κµ¬μ΅° λ¶„μ„

## ν”„λ΅μ νΈ κ°μ”
**μλ¥ μμ–΄ λ¬Έν•­ μλ™ μƒμ„± λ° κ²€μ¦ μ›Ή μ•±**μΌλ΅, LLM(Gemini/OpenAI)μ„ ν™μ©ν•μ—¬ λ¬Έν•­μ„ μƒμ„±ν•κ³  μ²΄κ³„μ μΌλ΅ κ²€μ¦ν•λ” μ‹μ¤ν…μ…λ‹λ‹¤.

---

## μ „μ²΄ λ””λ ‰ν† λ¦¬ κµ¬μ΅°

```
csat_mj_generator/
β”β”€β”€ GAS (Google Apps Script)     β† λ©”μΈ λ΅μ§ (1,034μ¤„)
β”‚   β”β”€β”€ Code.js                  - λ©”λ‰΄ + μ—”νΈλ¦¬ ν¬μΈνΈ + LOG/ERROR ν—¬νΌ
β”‚   β”β”€β”€ Config.js                - μ‹νΈ μ΄λ¦„ μƒμ & CONFIG λ΅λ”
β”‚   β”β”€β”€ io.js                    - ITEM_REQUEST/ITEM_JSON/ITEM_OUTPUT/ITEM_SET I/O
β”‚   β”β”€β”€ llmClient.js             - LLM API νΈμ¶ (Gemini/OpenAI μ„ νƒ)
β”‚   β”β”€β”€ promptBuilder.js         - ν”„λ΅¬ν”„νΈ κµ¬μ„± (MASTER + ITEM PROMPT)
β”‚   β”β”€β”€ normalizer.js            - LLM JSONμ„ λ‚΄λ¶€ ν‘μ¤€ν•μΌλ΅ μ •λ¦¬
β”‚   β”β”€β”€ passageGenerator.js      - μ§€λ¬Έ μλ™ μƒμ„± (ν•„μ” μ‹)
β”‚   β”β”€β”€ jsonUtils.js             - JSON νμ‹±
β”‚   β”β”€β”€ logger.js                - ν†µν•© λ΅κΉ… λ¨λ“ (INFO/WARN/ERROR)
β”‚   β”β”€β”€ repair.js                - μλ™ λ³΄μ • λ΅μ§ (placeholder)
β”‚   β”β”€β”€ retryManager.js          - μ¬μ‹λ„ κ΄€λ¦¬
β”‚   β”β”€β”€ itemSetProfileUtils.js   - μ„ΈνΈ ν”„λ΅ν•„ νμ‹±
β”‚   β”β”€β”€ validator_common.js      - κ³µν†µ κ²€μ¦ (ν•„μ ν•„λ“)
β”‚   β”β”€β”€ validator_grammar.js     - RC29 μ–΄λ²• λ¬Έν•­ κ²€μ¦ (λ°‘μ¤„ 5κ°)
β”‚   β”β”€β”€ validator_gap.js         - RC31~33 λΉμΉΈ λ¬Έν•­ κ²€μ¦
β”‚   β”β”€β”€ validator_chart.js       - RC25 λ„ν‘ λ¬Έν•­ κ²€μ¦
β”‚   β”β”€β”€ validator_set.js         - μ„ΈνΈ λ¬Έν•­(16-17, 41-42, 43-45) κ²€μ¦
β”‚   β”β”€β”€ appsscript.json          - GAS ν”„λ΅μ νΈ λ©”νƒ€λ°μ΄ν„°
β”‚   β””β”€β”€ .clasp.json              - clasp CLI μ„¤μ • (Google Apps Script ID)
β”‚
β”β”€β”€ web-app/                     β† Node.js + React μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…
β”‚   β”β”€β”€ package.json             - μ„λ²„ μμ΅΄μ„± κ΄€λ¦¬
β”‚   β”β”€β”€ .env.example             - ν™κ²½λ³€μ ν…ν”λ¦Ώ
β”‚   β”‚
β”‚   β”β”€β”€ server/                  - Express.js λ°±μ—”λ“ (~1,000μ¤„)
β”‚   β”‚   β”β”€β”€ index.js             - μ„λ²„ μ§„μ…μ  (ν¬νΈ 3001)
β”‚   β”‚   β”β”€β”€ db/
β”‚   β”‚   β”‚   β””β”€β”€ database.js      - SQL.js λ°μ΄ν„°λ² μ΄μ¤ μ΄κΈ°ν™” (SQLite)
β”‚   β”‚   β”β”€β”€ routes/              - API λΌμ°νΈ
β”‚   β”‚   β”‚   β”β”€β”€ config.js        - CONFIG κ΄€λ¦¬ API
β”‚   β”‚   β”‚   β”β”€β”€ prompts.js       - PROMPT_DB κ΄€λ¦¬ API
β”‚   β”‚   β”‚   β”β”€β”€ items.js         - λ¬Έν•­ μ”μ²­/μƒμ„± API
β”‚   β”‚   β”‚   β”β”€β”€ sets.js          - μ„ΈνΈ λ¬Έν•­ API
β”‚   β”‚   β”‚   β”β”€β”€ charts.js        - μ°¨νΈ λ°μ΄ν„° API
β”‚   β”‚   β”‚   β””β”€β”€ logs.js          - λ΅κ·Έ μ΅°ν API
β”‚   β”‚   β””β”€β”€ services/            - λΉ„μ¦λ‹μ¤ λ΅μ§
β”‚   β”‚       β”β”€β”€ itemPipeline.js  - λ¬Έν•­ μƒμ„± νμ΄ν”„λΌμΈ
β”‚   β”‚       β”β”€β”€ llmClient.js     - LLM νΈμ¶
β”‚   β”‚       β”β”€β”€ promptBuilder.js - ν”„λ΅¬ν”„νΈ κµ¬μ„±
β”‚   β”‚       β”β”€β”€ passageGenerator.js - μ§€λ¬Έ μƒμ„±
β”‚   β”‚       β”β”€β”€ jsonUtils.js     - JSON νμ‹±
β”‚   β”‚       β”β”€β”€ logger.js        - λ΅κΉ…
β”‚   β”‚       β”β”€β”€ configService.js - μ„¤μ • κ΄€λ¦¬
β”‚   β”‚       β””β”€β”€ validators/      - κ²€μ¦ λ¨λ“
β”‚   β”‚           β”β”€β”€ index.js
β”‚   β”‚           β”β”€β”€ common.js    - κ³µν†µ κ²€μ¦
β”‚   β”‚           β”β”€β”€ grammar.js   - RC29 κ²€μ¦
β”‚   β”‚           β”β”€β”€ gap.js       - RC31~33 κ²€μ¦
β”‚   β”‚           β”β”€β”€ chart.js     - RC25 κ²€μ¦
β”‚   β”‚           β””β”€β”€ set.js       - μ„ΈνΈ κ²€μ¦
β”‚   β”‚
β”‚   β”β”€β”€ client/                  - React ν”„λ΅ νΈμ—”λ“ (2,133μ¤„)
β”‚   β”‚   β”β”€β”€ package.json         - ν΄λΌμ΄μ–ΈνΈ μμ΅΄μ„±
β”‚   β”‚   β””β”€β”€ src/
β”‚   β”‚       β”β”€β”€ index.js         - React DOM λ λ”λ§
β”‚   β”‚       β”β”€β”€ App.js           - λΌμ°ν… + λ μ΄μ•„μ›ƒ
β”‚   β”‚       β”β”€β”€ api/
β”‚   β”‚       β”‚   β””β”€β”€ index.js     - API ν΄λΌμ΄μ–ΈνΈ (fetch λνΌ)
β”‚   β”‚       β”β”€β”€ pages/           - νμ΄μ§€ μ»΄ν¬λ„νΈ (8κ°)
β”‚   β”‚       β”‚   β”β”€β”€ Dashboard.js - λ€μ‹λ³΄λ“ (ν†µκ³„ + μ„λ²„ μƒνƒ)
β”‚   β”‚       β”‚   β”β”€β”€ ItemCreate.js - μƒ λ¬Έν•­ μƒμ„± νΌ
β”‚   β”‚       β”‚   β”β”€β”€ ItemRequests.js - λ¬Έν•­ μ”μ²­ λ©λ΅ + μƒμ„± μ‹¤ν–‰
β”‚   β”‚       β”‚   β”β”€β”€ ItemSets.js  - μ„ΈνΈ λ¬Έν•­ κ΄€λ¦¬
β”‚   β”‚       β”‚   β”β”€β”€ Prompts.js   - ν”„λ΅¬ν”„νΈ νΈμ§‘
β”‚   β”‚       β”‚   β”β”€β”€ Charts.js    - λ„ν‘ λ°μ΄ν„° κ΄€λ¦¬
β”‚   β”‚       β”‚   β”β”€β”€ Config.js    - ν™κ²½μ„¤μ • (API KEY, λ¨λΈ λ“±)
β”‚   β”‚       β”‚   β””β”€β”€ Logs.js      - λ΅κ·Έ μ΅°ν
β”‚   β”‚       β””β”€β”€ styles/
β”‚   β”‚           β””β”€β”€ global.css   - μ „μ—­ μ¤νƒ€μΌ
β”‚   β”‚
β”‚   β””β”€β”€ data/
β”‚       β””β”€β”€ csat.db              - SQLite λ°μ΄ν„°λ² μ΄μ¤ (μλ™ μƒμ„±)
β”‚
β”β”€β”€ README.md                    - ν”„λ΅μ νΈ μ„¤λ…
β””β”€β”€ .git/                        - Git μ €μ¥μ†
```

---

## κΈ°μ  μ¤νƒ

### λ°±μ—”λ“ (Google Apps Script)
| κΈ°μ  | μ©λ„ |
|------|------|
| **Google Apps Script (GAS)** | Google Sheets μ—°λ™ μλ™ν™” ν”λ«νΌ |
| **Gemini API** | λ¬Έν•­ μƒμ„± (κΈ°λ³Έκ°’) |
| **OpenAI API (ChatGPT)** | λ¬Έν•­ μƒμ„± (λ€μ•) |
| **UrlFetchApp** | HTTP μ”μ²­ (API νΈμ¶) |
| **SpreadsheetApp** | Google Sheets λ°μ΄ν„° μ½κΈ°/μ“°κΈ° |
| **PropertiesService** | API Key λ“± λ³΄μ• μ €μ¥μ† |

### μ›Ή μ„λ²„
| κΈ°μ  | λ²„μ „ | μ©λ„ |
|------|------|------|
| **Node.js** | - | JavaScript λ°νƒ€μ„ |
| **Express.js** | 4.18.2 | REST API μ„λ²„ |
| **SQL.js** | 1.10.0 | μμ JavaScript SQLite DB |
| **CORS** | 2.8.5 | ν¬λ΅μ¤-μ¤λ¦¬μ§„ μ”μ²­ μ²λ¦¬ |
| **express-session** | 1.17.3 | μ„Έμ… κ΄€λ¦¬ |
| **bcryptjs** | 2.4.3 | μ•”νΈν™” |
| **uuid** | 9.0.0 | ID μƒμ„± |
| **dotenv** | 16.3.1 | ν™κ²½λ³€μ κ΄€λ¦¬ |

### ν”„λ΅ νΈμ—”λ“
| κΈ°μ  | λ²„μ „ | μ©λ„ |
|------|------|------|
| **React** | 18.2.0 | UI ν”„λ μ„μ›ν¬ |
| **React Router** | 6.20.0 | νμ΄μ§€ λΌμ°ν… |
| **Fetch API** | - | HTTP ν†µμ‹  |

### κ°λ° λ„κµ¬
- **clasp** - Google Apps Script λ°°ν¬
- **nodemon** - μλ™ μ¬μ‹μ‘
- **react-scripts** - React λΉλ“ λ„κµ¬

---

## ν•µμ‹¬ κΈ°λ¥ λ° λ°μ΄ν„° νλ¦„

### λ¬Έν•­ μƒμ„± νμ΄ν”„λΌμΈ (generateItemPipeline)

```
1λ‹¨κ³„: μ§€λ¬Έ μƒμ„± (ν•„μ”μ‹)
  β””β”€> generatePassageIfNeeded()
      - PASSAGEκ°€ μ—†κ±°λ‚ "(AUTO)" ν‘μ‹ μ‹ LLMμ΄ μ§€λ¬Έ μƒμ„±
      - PASSAGE_SOURCE="MANUAL"μ΄λ©΄ μ—λ¬ μ²λ¦¬

2λ‹¨κ³„: ν”„λ΅¬ν”„νΈ κµ¬μ„±
  β””β”€> buildPromptBundle()
      - MASTER_PROMPT + ITEM_PROMPT λ΅λ“
      - μ§€λ¬Έ(PASSAGE_GIVEN) λλ” μƒμ„± μ§€μ‹ μ¶”κ°€
      - λ‚μ΄λ„, μ¶”κ°€λ©”λ¨, λ„ν‘ λ°μ΄ν„° ν¬ν•¨

3λ‹¨κ³„: LLM νΈμ¶
  β””β”€> callLLM()
      - Gemini (κΈ°λ³Έ) λλ” OpenAI (μ„ νƒ)
      - System Prompt + User Prompt μ „λ‹¬
      - JSON μ‘λ‹µ λ°ν™

4λ‹¨κ³„: JSON νμ‹±
  β””β”€> parseItemJson()
      - ```json ``` μ½”λ“λΈ”λ΅ μ κ±°
      - μ²« { ~ λ§μ§€λ§‰ } μ¶”μ¶ λ° JSON.parse()

5λ‹¨κ³„: μ •κ·ν™”
  β””β”€> normalizeItemJson()
      - question, options[5], answer, explanation λ³΄μ •
      - logic_proof, passage, grammar_meta λ“± μ ν•λ³„ ν•„λ“ λ³΄μ΅΄

6λ‹¨κ³„: κ³µν†µ κ²€μ¦
  β””β”€> validateCommon()
      - question ν•„μ, options[5] λ°°μ—΄, answer(1~5), explanation

7λ‹¨κ³„: μ ν•λ³„ μ¶”κ°€ κ²€μ¦
  β”β”€> validateGrammarItem() [RC29]
  β”‚   - μ§€λ¬Έ λ‚΄ <u>...</u> λ°‘μ¤„ μ •ν™•ν 5κ°
  β”‚   - grammar_meta[5] λ°°μ—΄ + is_correct=false μ •ν™•ν 1κ°
  β”β”€> validateGapItem() [RC31~33]
  β”‚   - gapped_passage ν•„λ“ ν•„μ
  β”‚   - (___)λλ”___ λΉμΉΈ μ •ν™•ν 1κ°
  β”‚   - μ›λ³Έ μ§€λ¬Έκ³Όμ λ³€ν• κ²€μ‚¬ (μλ™ μƒμ„± μ‹ μƒλµ)
  β””β”€> validateChartItem() [RC25]
      - λ„ν‘ λ°μ΄ν„° ν•μ‹ κ²€μ‚¬

8λ‹¨κ³„: μ¬μ‹λ„ (μ‹¤ν¨ μ‹)
  β””β”€> μµλ€ MAX_RETRY νμκΉμ§€ λ°λ³µ
```

### μ„ΈνΈ λ¬Έν•­ μ²λ¦¬ (runForSetId)
```
1. SET_IDλ΅ ν•΄λ‹Ή λ¬Έν•­ ν–‰λ“¤ λ¨λ‘ λ΅λ“ (readRequestsForSet)
2. ITEM_SET μ‹νΈμ—μ„ κ³µν†µ μ§€λ¬Έ λ΅λ“ (readSetInfo)
3. κ° μ”μ²­μ— κ³µν†µ μ§€λ¬Έ μ£Όμ…
4. κ°λ³„ μƒμ„± νμ΄ν”„λΌμΈ μ‹¤ν–‰ (generateItemPipeline)
5. μ„ΈνΈ λ‹¨μ„ μµμΆ… κ²€μ¦ (validateItemSet)
   - ν¨ν„΄ κ²€μ‚¬: [16-17], [41-42], [43-45] μ¤‘ ν•λ‚
   - λ¨λ“  λ¬Έν•­μ΄ PASSμ—¬μ•Ό ν•¨
```

### λ©”λ‰΄ κΈ°λ° μ‹¤ν–‰ (GAS)
```
π“ KSAT Human-Prompt Engine
β”β”€ μ„ νƒ ν–‰ λ¬Έν•­ μƒμ„± (runForSelectedRow)
β”‚  β””β”€ ν„μ¬ ν–‰μ ITEM_REQUESTλ§ μ²λ¦¬
β”β”€ μ „μ²΄ PENDING μ²λ¦¬ (runForAllPending)
β”‚  β””β”€ STATUS=PENDINGμΈ λ¨λ“  ν–‰ μΌκ΄„ μ²λ¦¬ (μ„ΈνΈ μ μ™Έ)
β””β”€ μ„ΈνΈ λ¬Έν•­ μƒμ„± (runForSetIdPrompt)
   β””β”€ SET_ID μ…λ ¥λ°›μ•„ ν•΄λ‹Ή μ„ΈνΈ μƒμ„±
```

---

## λ°μ΄ν„° λ¨λΈ

### Google Sheets μ‹νΈ κµ¬μ΅°
| μ‹νΈλ… | μ©λ„ | μ£Όμ” μ»¬λΌ |
|--------|------|---------|
| **CONFIG** | μ„¤μ •κ°’ μ €μ¥ | KEY, VALUE |
| **PROMPT_DB** | ν”„λ΅¬ν”„νΈ μ €μ¥μ† | MASTER_PROMPT, P18~P40(μ§€λ¬Έ), ITEM_NO(λ¬Έν•­), TITLE, PROMPT_TEXT, ACTIVE_FLAG |
| **ITEM_REQUEST** | λ¬Έν•­ μƒμ„± μ”μ²­ | REQUEST_ID, STATUS, ITEM_NO, PASSAGE, LEVEL, EXTRA, CREATED_AT, UPDATED_AT, CHART_ID, SET_ID, PASSAGE_SOURCE, TOPIC |
| **ITEM_JSON** | μƒμ„±λ JSON | REQUEST_ID, RAW_JSON, NORMALIZED_JSON, VALIDATION_RESULT, VALIDATION_LOG, REPAIR_LOG, DIFFICULTY_EST, DISTRACTOR_SCORE, FINAL_JSON |
| **ITEM_OUTPUT** | μµμΆ… λ¬Έν•­ | REQUEST_ID, ITEM_NO, QUESTION, OPTION_1~5, ANSWER, EXPLANATION, LOGIC_PROOF, DIFFICULTY_EST, DISTRACTOR_META |
| **ITEM_SET** | μ„ΈνΈ μ •λ³΄ | SET_ID, SET_NAME, COMMON_PASSAGE, PROFILE |
| **CHART_DB** | λ„ν‘ λ°μ΄ν„° | CHART_ID, CHART_NAME, RAW_DATA_JSON |
| **LOG** | μΌλ° λ΅κ·Έ | TIMESTAMP, LEVEL, TAG, REQUEST_ID, MESSAGE |
| **ERROR** | μ—λ¬ λ΅κ·Έ | TIMESTAMP, REQUEST_ID, FUNC_NAME, ERROR_MESSAGE, STACK |

### SQL λ°μ΄ν„°λ² μ΄μ¤ (web-app)
- **config** - μ„¤μ •κ°’ (KEY-VALUE)
- **prompts** - ν”„λ΅¬ν”„νΈ DB (prompt_key, title, prompt_text, active)
- **item_requests** - λ¬Έν•­ μ”μ²­ (request_id, status, item_no, passage, etc.)
- **item_outputs** - μƒμ„±λ λ¬Έν•­ (request_id, question, options, answer, etc.)
- **item_sets** - μ„ΈνΈ (set_id, set_name, passage, profile)
- **charts** - λ„ν‘ (chart_id, chart_data)
- **logs** - λ΅κ·Έ (timestamp, level, message)

---

## API μ—”λ“ν¬μΈνΈ (REST)

### μ„¤μ • API
```
GET    /api/config              - λ¨λ“  μ„¤μ • μ΅°ν
PUT    /api/config/:key         - νΉμ • μ„¤μ • μ—…λ°μ΄νΈ
POST   /api/config/batch        - μΌκ΄„ μ—…λ°μ΄νΈ
```

### ν”„λ΅¬ν”„νΈ API
```
GET    /api/prompts             - λ¨λ“  ν”„λ΅¬ν”„νΈ μ΅°ν
GET    /api/prompts/:key        - νΉμ • ν”„λ΅¬ν”„νΈ μ΅°ν
POST   /api/prompts             - μƒ ν”„λ΅¬ν”„νΈ μƒμ„±
PUT    /api/prompts/:key        - ν”„λ΅¬ν”„νΈ μμ •
DELETE /api/prompts/:key        - ν”„λ΅¬ν”„νΈ μ‚­μ 
```

### λ¬Έν•­ API
```
GET    /api/items/requests                - λ¬Έν•­ μ”μ²­ λ©λ΅ (ν•„ν„°λ§, νμ΄μ§€λ„¤μ΄μ…)
GET    /api/items/requests/:id            - νΉμ • μ”μ²­ μ΅°ν
POST   /api/items/requests                - μƒ μ”μ²­ μƒμ„±
DELETE /api/items/requests/:id            - μ”μ²­ μ‚­μ 
POST   /api/items/generate/:id            - νΉμ • λ¬Έν•­ μƒμ„± μ‹¤ν–‰
POST   /api/items/generate-pending        - λ¨λ“  PENDING μΌκ΄„ μ²λ¦¬
GET    /api/items/outputs                 - μƒμ„±λ λ¬Έν•­ μ΅°ν
```

### μ„ΈνΈ API
```
GET    /api/sets                          - λ¨λ“  μ„ΈνΈ μ΅°ν
GET    /api/sets/:setId                   - νΉμ • μ„ΈνΈ μ΅°ν
POST   /api/sets                          - μƒ μ„ΈνΈ μƒμ„±
PUT    /api/sets/:setId                   - μ„ΈνΈ μμ •
DELETE /api/sets/:setId                   - μ„ΈνΈ μ‚­μ 
POST   /api/sets/:setId/generate          - μ„ΈνΈ λ¬Έν•­ μƒμ„±
POST   /api/sets/:setId/requests          - μ„ΈνΈμ— λ¬Έν•­ μ¶”κ°€
```

### λ„ν‘ API
```
GET    /api/charts                        - λ¨λ“  λ„ν‘ μ΅°ν
GET    /api/charts/:chartId               - νΉμ • λ„ν‘ μ΅°ν
POST   /api/charts                        - μƒ λ„ν‘ μƒμ„±
PUT    /api/charts/:chartId               - λ„ν‘ μμ •
DELETE /api/charts/:chartId               - λ„ν‘ μ‚­μ 
```

### λ΅κ·Έ API
```
GET    /api/logs                          - λ΅κ·Έ μ΅°ν
GET    /api/logs/errors                   - μ—λ¬ λ΅κ·Έ μ΅°ν
GET    /api/logs/stats                    - λ΅κ·Έ ν†µκ³„
DELETE /api/logs/clear?days=30            - μ¤λλ λ΅κ·Έ μ‚­μ 
GET    /api/health                        - ν—¬μ¤ μ²΄ν¬
```

---

## μ›Ή UI νμ΄μ§€ κµ¬μ„±

| νμ΄μ§€ | νμΌ | κΈ°λ¥ | λΌμΈ μ |
|--------|------|------|--------|
| **λ€μ‹λ³΄λ“** | Dashboard.js | ν†µκ³„, μµκ·Ό μ”μ²­, μ„λ²„ μƒνƒ | 205 |
| **λ¬Έν•­ μ”μ²­** | ItemRequests.js | μ”μ²­ λ©λ΅, μƒνƒ ν•„ν„°, μƒμ„± μ‹¤ν–‰ | 289 |
| **μƒ λ¬Έν•­ μƒμ„±** | ItemCreate.js | λ¬Έν•­ μ ν• μ„ νƒ, μ§€λ¬Έ/λ‚μ΄λ„ μ…λ ¥ νΌ | 246 |
| **μ„ΈνΈ λ¬Έν•­** | ItemSets.js | μ„ΈνΈ CRUD, ν”„λ΅ν•„ κ΄€λ¦¬ | 355 |
| **ν”„λ΅¬ν”„νΈ κ΄€λ¦¬** | Prompts.js | PROMPT_DB νΈμ§‘ | 264 |
| **μ°¨νΈ λ°μ΄ν„°** | Charts.js | λ„ν‘ CRUD | 266 |
| **μ„¤μ •** | Config.js | API KEY, λ¨λΈ, μ¨λ„, LOG_LEVEL λ“± | 246 |
| **λ΅κ·Έ** | Logs.js | λ΅κ·Έ/μ—λ¬ μ΅°ν, ν†µκ³„ | 262 |

---

## κ²€μ¦ μ‹μ¤ν…

### κ³µν†µ κ²€μ¦ (validateCommon)
- question ν•„λ“ ν•„μ
- options λ°°μ—΄ μ •ν™•ν 5κ°
- answer ν•„λ“ μ΅΄μ¬ λ° 1~5 λ²”μ„
- explanation ν•„λ“ (κ¶μ¥)

### RC29 μ–΄λ²• λ¬Έν•­ κ²€μ¦ (validateGrammarItem)
- μ§€λ¬Έ λ‚΄ `<u>...</u>` λ°‘μ¤„ μ •ν™•ν 5κ°
- grammar_meta[5] λ°°μ—΄
- grammar_meta[i].index, is_correct ν•„λ“
- is_correct=falseμΈ ν•­λ© μ •ν™•ν 1κ°

### RC31~33 λΉμΉΈ λ¬Έν•­ κ²€μ¦ (validateGapItem)
- gapped_passage ν•„λ“ ν•„μ
- `(___)`λλ”`___` ν•νƒμ λΉμΉΈ μ •ν™•ν 1κ°
- μ›λ³Έ μ§€λ¬Έκ³Όμ λ³€ν• κ²€μ‚¬ (μλ™ μƒμ„± λ¨λ“μ—μ„λ” μƒλµ)

### RC25 λ„ν‘ λ¬Έν•­ κ²€μ¦ (validateChartItem)
- λ„ν‘ λ°μ΄ν„° ν•μ‹ κ²€μ‚¬
- options[5] λ°°μ—΄ ν™•μΈ

### μ„ΈνΈ λ¬Έν•­ κ²€μ¦ (validateItemSet)
- μ„ΈνΈ ν¨ν„΄ ν™•μΈ: [16-17], [41-42], [43-45]
- λ²”μ„ λ‚΄ λ¨λ“  λ¬Έν•­ λ²νΈ μ΅΄μ¬
- κ° λ¬Έν•­μ΄ PASSμ—¬μ•Ό ν•¨
- κ³µν†µ μ§€λ¬Έ μΌκ΄€μ„± ν™•μΈ

---

## μ£Όμ” μ„¤μ • νμΌ

### web-app/.env.example (ν™κ²½ λ³€μ)
```
# μ„λ²„ μ„¤μ •
PORT=3001
NODE_ENV=development

# API ν‚¤ μ„¤μ •
GEMINI_API_KEY=your_gemini_api_key_here
OPENAI_API_KEY=your_openai_api_key_here

# LLM μ„¤μ •
PROVIDER=gemini
GEMINI_MODEL=gemini-2.5-pro
OPENAI_MODEL=gpt-4.1-mini
TEMP_BASE=0.4
MAX_RETRY=3

# λ΅κ·Έ λ λ²¨
LOG_LEVEL=INFO

# μ„Έμ… μ‹ν¬λ¦Ώ
SESSION_SECRET=your_session_secret_here
```

---

## μ‹¤ν–‰ νλ¦„ μ”μ•½

### Google Sheets κΈ°λ° μ‹¤ν–‰ (GAS)
```
μ‚¬μ©μκ°€ GAS λ©”λ‰΄ ν΄λ¦­
  β†“
Code.jsμ runForSelectedRow() / runForAllPending() / runForSetIdPrompt()
  β†“
generateItemPipeline() νΈμ¶ (8λ‹¨κ³„ νμ΄ν”„λΌμΈ)
  β†“
κ²°κ³Όλ¥Ό ITEM_JSON, ITEM_OUTPUT μ‹νΈμ— μ €μ¥
  β†“
LOG/ERROR μ‹νΈμ— λ΅κ·Έ κΈ°λ΅
```

### μ›Ή μ•± κΈ°λ° μ‹¤ν–‰
```
React ν”„λ΅ νΈμ—”λ“ (http://localhost:3000)
  β†“
fetch λλ” itemsApi νΈμ¶ (React)
  β†“
Express λΌμ°νΈ μ²λ¦¬ (/api/items/generate)
  β†“
itemPipeline.jsμ generateItemPipeline()
  β†“
SQL.js λ°μ΄ν„°λ² μ΄μ¤μ— μ €μ¥
  β†“
JSON μ‘λ‹µ λ°ν™
  β†“
React UI μ—…λ°μ΄νΈ
```

---

## μ½”λ“ κ·λ¨

| λ¨λ“ | λΌμΈ μ | μ„¤λ… |
|------|--------|------|
| **GAS (λ£¨νΈ)** | 1,034 | λ¬Έν•­ μƒμ„± λ΅μ§ λ° κ²€μ¦ |
| **μ›Ήμ•± μ„λ²„** | ~1,000 | Express API + μ„λΉ„μ¤ |
| **μ›Ήμ•± ν΄λΌμ΄μ–ΈνΈ** | 2,133 | React νμ΄μ§€ μ»΄ν¬λ„νΈ |
| **μ΄ν•©** | ~4,000+ | μ „μ²΄ μ‹μ¤ν… |

---

## μ£Όμ” κΈ°λ¥ λ§¤νΈλ¦­μ¤

| κΈ°λ¥ | GAS | μ›Ήμ•± | λΉ„κ³  |
|------|-----|------|------|
| λ¬Έν•­ μƒμ„± | β“ | β“ | μ–‘μ½ λ¨λ‘ μ§€μ› |
| ν”„λ΅¬ν”„νΈ κ΄€λ¦¬ | β“ | β“ | PROMPT_DB λ™κΈ°ν™” ν•„μ” |
| μ„ΈνΈ λ¬Έν•­ μ²λ¦¬ | β“ | β“ | ν¨ν„΄ κ²€μ¦ ν¬ν•¨ |
| κ²€μ¦ (κ³µν†µ/μ ν•λ³„) | β“ | β“ | 5κ°€μ§€ κ²€μ¦κΈ° |
| λ΅κΉ… | β“ | β“ | LOG/ERROR μ‹νΈ λλ” DB |
| λ„ν‘ λ°μ΄ν„° | β“ | β“ | CHART_DB λ™κΈ°ν™” |
| μ§€λ¬Έ μλ™ μƒμ„± | β“ | β“ | PASSAGE λΉ„μ–΄μμ„ λ• |
| UI λ€μ‹λ³΄λ“ | β— | β“ | μ›Ήμ•±λ§ μ κ³µ |
| μ„¤μ • κ΄€λ¦¬ | β“ | β“ | CONFIG μ‹νΈ λλ” .env |

---

## κΈ°μ μ  νΉμ§•

### μ¥μ 
- **μ΄μ¤‘ μ‹¤ν–‰ ν™κ²½**: Google Sheets + μ›Ήμ•± λ™μ‹ μ§€μ›
- **μ μ—°ν• LLM μ„ νƒ**: Gemini (κΈ°λ³Έ) / OpenAI (μ„ νƒ)
- **μ„Έλ°€ν• κ²€μ¦**: μ ν•λ³„ 5κ°€μ§€ κ²€μ¦κΈ° (κ³µν†µ, μ–΄λ²•, λΉμΉΈ, λ„ν‘, μ„ΈνΈ)
- **μλ™ μ§€λ¬Έ μƒμ„±**: PASSAGE μ—†μ„ μ‹ LLMμ΄ μλ™ μƒμ„±
- **μ„ΈνΈ λ¬Έν•­ μ§€μ›**: 16-17, 41-42, 43-45 ν¨ν„΄
- **μ¬μ‹λ„ λ©”μ»¤λ‹μ¦**: μƒμ„± μ‹¤ν¨ μ‹ μλ™ μ¬μ‹λ„
- **μƒμ„Έ λ΅κΉ…**: INFO/WARN/ERROR 3λ‹¨κ³„ λ΅κ·Έ λ λ²¨

### κ°μ„  ν•„μ” μμ—­
- **μλ™ λ³΄μ • (repair.js)**: ν„μ¬ placeholder μƒνƒ
- **λ°μ΄ν„° λ™κΈ°ν™”**: GAS β†” μ›Ήμ•± κ°„ λ™κΈ°ν™” λ©”μ»¤λ‹μ¦ λ¶€μ¬
- **μ—λ¬ λ³µκµ¬**: μ‹¤ν¨ν• μƒμ„±μ μλ™ λ³µκµ¬ λ΅μ§ λ―Έν΅
- **ν•™μƒ UI/UX**: ν„μ¬ κ΄€λ¦¬μ/κ°λ°μ μ¤‘μ‹¬ β†’ ν•™μƒ μΉν™”μ  λ²„μ „ ν•„μ”

---

## κ²°λ΅ 

μ΄ ν”„λ΅μ νΈλ” **Google Apps Script κΈ°λ° λ©”μΈ μ—”μ§„ + Node.js μ›Ήμ•± λ³΄μ΅° ν”λ«νΌ**μΌλ΅ κµ¬μ„±λ **μ΄μ¤‘ κµ¬μ΅° μ‹μ¤ν…**μ…λ‹λ‹¤.

- **GAS**: λ©”μΈ μ²λ¦¬ μ—”μ§„ (Google Sheets κΈ°λ°)
- **μ›Ήμ•±**: κ΄€λ¦¬ λ° λ¨λ‹ν„°λ§ UI

LLMμ„ ν™μ©ν• μλ¥ μμ–΄ λ¬Έν•­ μλ™ μƒμ„±κ³Ό λ‹¤μ–‘ν• μ ν•μ— λ€ν• μ„Έλ°€ν• κ²€μ¦μ΄ νΉμ§•μ΄λ©°, ν–¥ν›„ **ν•™μƒ μ‚¬μ©μ μ¤‘μ‹¬μ UI/UX κ°μ„ **κ³Ό **GAS-μ›Ήμ•± κ°„ λ°μ΄ν„° λ™κΈ°ν™” κ°•ν™”**κ°€ ν•„μ”ν•©λ‹λ‹¤.
